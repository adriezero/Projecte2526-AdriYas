generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "mysql"
}

model administrador {
  ID          Int                  @id @default(autoincrement())
  Nombre      String               @db.VarChar(50)
  Email       String?              @db.VarChar(50)
  Permisos    String?              @db.VarChar(255)
  Contrase_a  String               @map("Contraseña") @db.VarChar(25)
  Estado      administrador_Estado @default(dbgenerated("(Disponible)"))
  comentarios comentarios[]
  rol         rol[]
}

model camionero {
  ID                Int                 @id @default(autoincrement())
  Nombre            String              @db.VarChar(50)
  Email             String?             @db.VarChar(50)
  Licencia          camionero_Licencia
  Telf              String              @db.VarChar(10)
  Disponible        Boolean             @default(true)
  idTurno           Int
  FechaInicio       DateTime            @db.Date
  FechaFinal        DateTime            @db.Date
  turnos            turnos              @relation(fields: [idTurno], references: [ID], onDelete: Cascade, map: "fk_idCamionero")
  rutas             rutas[]
  solicitud_reserva solicitud_reserva[]

  @@index([idTurno], map: "camionero_ibfk_5")
}

model cliente {
  ID                Int                  @id @default(autoincrement())
  Nombre            String               @db.VarChar(50)
  NombreEmpresa     String               @db.VarChar(150)
  RazonSocial       String?              @db.VarChar(255)
  Email             String?              @db.VarChar(50)
  Contrase_a        String               @map("Contraseña") @db.VarChar(25)
  Telf              String               @db.VarChar(10)
  EstadoCuenta      cliente_EstadoCuenta @default(dbgenerated("(Disponible)"))
  comentarios       comentarios[]
  informes          informes[]
  solicitud_reserva solicitud_reserva[]
}

model comentarios {
  ID            Int            @id @default(autoincrement())
  Contenido     String?        @db.VarChar(200)
  Fecha         DateTime       @db.Date
  Moderado      Boolean?       @default(false)
  Administrador Int?
  Ruta          Int
  Cliente       Int
  administrador administrador? @relation(fields: [Administrador], references: [ID], onDelete: Cascade, map: "fk_idAdministrador")
  cliente       cliente        @relation(fields: [Cliente], references: [ID], onDelete: Cascade, map: "fk_idCliente")
  rutas         rutas          @relation(fields: [Ruta], references: [ID], onDelete: Cascade, map: "fk_idRuta")

  @@index([Administrador], map: "comentarios_ibfk_7")
  @@index([Ruta], map: "comentarios_ibfk_8")
  @@index([Cliente], map: "comentarios_ibfk_9")
}

model dispatcher {
  ID              Int          @id @default(autoincrement())
  Nombre          String       @db.VarChar(50)
  Email           String       @db.VarChar(50)
  Contrase_a      String       @map("Contraseña") @db.VarChar(25)
  CentroOperacion String?      @db.VarChar(255)
  documentos      documentos[]
  informes        informes[]
}

model documentos {
  ID          Int        @id @default(autoincrement())
  Nombre      String     @db.VarChar(50)
  Descripci_n String     @map("Descripción") @db.VarChar(150)
  FechaSubida DateTime   @db.Date
  Dispatcher  Int
  dispatcher  dispatcher @relation(fields: [Dispatcher], references: [ID], onDelete: Cascade, map: "fk_idDispatcher")

  @@index([Dispatcher], map: "documentos_ibfk_2")
}

model informes {
  ID           Int               @id @default(autoincrement())
  Tipo         String            @db.VarChar(50)
  Formato      informes_Formato?
  FechaSubida  DateTime          @db.Date
  idDispatcher Int
  idCliente    Int
  cliente      cliente           @relation(fields: [idCliente], references: [ID], onDelete: Cascade, map: "fk_idCliente_2")
  dispatcher   dispatcher        @relation(fields: [idDispatcher], references: [ID], onDelete: Cascade, map: "fk_idDispatcher_2")

  @@index([idDispatcher], map: "informes_ibfk_3")
  @@index([idCliente], map: "informes_ibfk_4")
}

model reservas {
  ID                Int                 @id @default(autoincrement())
  Fecha             DateTime            @db.Date
  Motivo            String              @db.VarChar(150)
  Descripci_n       String?             @map("Descripción") @db.VarChar(255)
  solicitud_reserva solicitud_reserva[]
}

model rol {
  ID            Int           @id @default(autoincrement())
  Nombre        String        @db.VarChar(50)
  Descripci_n   String?       @map("Descripción") @db.VarChar(150)
  idAdmin       Int
  administrador administrador @relation(fields: [idAdmin], references: [ID], onDelete: Cascade, map: "fk_idAdministrador_2")

  @@index([idAdmin], map: "rol_ibfk_1")
}

model rutas {
  ID           Int           @id @default(autoincrement())
  Estado       rutas_Estado?
  Reservas     String        @db.LongText
  Cargas       String        @db.LongText
  EnTiempoReal Boolean       @default(false)
  Camionero    Int
  Origen       String        @db.VarChar(255)
  Destino      String        @db.VarChar(255)
  comentarios  comentarios[]
  camionero    camionero     @relation(fields: [Camionero], references: [ID], onDelete: Cascade, map: "fk_idCamionero_2")

  @@index([Camionero], map: "rutas_ibfk_6")
}

model solicitud_reserva {
  idReserva   Int
  idCliente   Int
  idCamionero Int
  camionero   camionero @relation(fields: [idCamionero], references: [ID], onUpdate: Restrict, map: "fk_idCamionero_3")
  cliente     cliente   @relation(fields: [idCliente], references: [ID], onUpdate: Restrict, map: "fk_idCliente_3")
  reservas    reservas  @relation(fields: [idReserva], references: [ID], onUpdate: Restrict, map: "fk_idReserva")

  @@id([idReserva, idCliente])
  @@index([idCamionero], map: "idCamionero")
  @@index([idCliente], map: "idCliente")
  @@index([idReserva], map: "idReserva")
}

model turnos {
  ID          Int         @id @default(autoincrement())
  Descripci_n String      @map("Descripción") @db.VarChar(255)
  camionero   camionero[]
}

enum rutas_Estado {
  Programado
  Cargando
  En_ruta
  En_pausa
  Finalizado
  Incidente
}

enum informes_Formato {
  CSV
  PDF
}

enum camionero_Licencia {
  A
  B
  C
  C1
  CE
  D
  E
}

enum administrador_Estado {
  Disponible
  Ocupado
  No_molestar @map("No molestar")
  Ausente
  D_a_libre   @map("Día libre")
}

enum cliente_EstadoCuenta {
  Disponible
  Ocupado
  No_molestar @map("No molestar")
  Ausente
  D_a_libre   @map("Día libre")
}
